#!/bin/bash
AWSCLI='/usr/local/bin/docker run --rm -v /Users/ckim/.aws:/root/.aws:ro awscli aws'
JQPATH=/usr/local/bin/jq
for RRR in $($AWSCLI ec2 describe-regions  --query 'Regions[].{Name:RegionName}' --output text) ; do $AWSCLI --region $RRR ec2 describe-instances --query 'Reservations[].Instances[]|[0].{az:Placement.AvailabilityZone,type:InstanceType,id:InstanceId,name:Tags[?Key==`Name`]|[0].Value}' | $JQPATH -c . ; done